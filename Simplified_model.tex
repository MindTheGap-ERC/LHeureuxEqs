\documentclass[10pt, letterpaper]{article}
\usepackage{amsmath}
\title{The diagenetic model by L'Heureux (2018)}
\author{Emilia Jarochowska & Niklas Hohmann}
\date{31 December 2023}

\begin{document}
\maketitle

\section{Description}
The model describes the evolution of the concentrations of five variables:
\begin{enumerate}
    \item Solids: two minerals which dissolve and (re)precipitate from/to the \textbf{same} solutes 
    \begin{enumerate}
        \item $C_C$ - Calcite
        \item $C_A$ - Aragonite
    \end{enumerate}
    \item Solutes $\hat{c}_k$, where $k \in \{Ca, CO_{3}\}$
    \begin{enumerate}
        \item $c_{Ca}$ - Calcium 
        \item $c_{CO_{3}}$ - Carbonate 
    \end{enumerate}
    \item Porosity $\phi$
\end{enumerate}

\section{Equations}
\begin{equation}
\frac{\partial}{\partial_t} C_A = -U\frac{\partial}{\partial_x} C_A - \operatorname{Da}\left[(1 - C_A)C_A (\Omega_{DA} - \nu_1 \Omega_{PA}) \\
        + \lambda C_A C_C (\Omega_{PC} - \nu_2 \Omega_{DC})\right] \tag{40}
\end{equation}

\begin{equation}
\frac{\partial}{\partial_t} C_C = -U\frac{\partial}{\partial_x} C_C + \\\operatorname{Da}\left[\lambda(1-C_C)C_C(\Omega_{PC} - \nu_2 \Omega_{DC}) + C_A C_C (\Omega_{DA} - \nu_1 \Omega_{PA})\right] \tag{41}
\end{equation}

\begin{equation}
\begin{align*}
   \frac{\partial}{\partial_t} \hat{c}_k = -W \frac{\partial}{\partial_x} \hat{c}_k + \frac{1}{\phi} \frac{\partial}{\partial_x} \left(\phi d_k \frac{\partial\hat{c}_k}{\partial_x}\right )+ \\
   \operatorname{Da} \frac{(1 - \phi)}{\phi} (\delta - \hat{c}_k) \left[C_A (\Omega_{DA} - \nu_1 \Omega_{PA}) - \lambda C_C (\Omega_{PC} - \nu_2 \Omega_{DC})\right] \tag{42}
\end{align*}
\end{equation}

The third equation solves for two quantities, $\hat{c_k}$ being a rescaled concentration of dissolved species, $Ca$ and $CO_3$. Both these quantities appear in the definitions of $\Omega_i$ (which are therefore functions of $x$).
\begin{equation}
\frac{\partial}{\partial_t} \phi = - \frac{\partial}{\partial_x}(W\phi) + d_{\phi} \frac{\partial^2\phi}{\partial x^2} + \operatorname{Da}(1 - \phi) \left[C_A(\Omega_{DA} - \nu_1\Omega_{PA}) - \\\lambda C_C(\Omega_{PC} - \nu_2\Omega_{DC})\right] \tag{43}
\end{equation}

Individual terms are expanded below.

\subsection{Saturation factors $\Omega_{PA}$, $\Omega_{DA}$, $\Omega_{PC}$ and $\Omega_{DC}$ (Eq. 45)} 

\begin{equation}
\begin{align}
\Omega_{PA} &= max\left[0, \left(\frac{\hat{c}_{Ca} \hat{c}_{CO3} K_C}{K_A} - 1 \right)\right]^m \nonumber \\
\Omega_{DA} &= max\left[0, \left(1 - \frac{\hat{c}_{Ca} \hat{c}_{CO3} K_C}{K_A} \right)\right] ^{m'} \theta(x) \nonumber 
\end{align}
\end{equation}

where $\theta(x)$ is a characteristic function indicating that aragonite dissolution is activated in a specific interval (ADZ, see the next section) of $x$ only. 
\begin{equation}
\begin{align}
\theta(x) &= \begin{cases}
    1  &\mbox{if } x_d/X* < x < (x_d + h_d)/X* \\
    0  &\mbox{otherwise } 
\end{cases} \\
\end{align}
\end{equation}

\begin{equation}
\begin{align}
\Omega_{PC} &= max\left[0, (\hat{c}_{Ca} \hat{c}_{CO3}  - 1 )\right] ^n \nonumber  \\
\Omega_{DC} &= max\left[0, (1 - \hat{c}_{Ca} \hat{c}_{CO3})\right]^{n'} \nonumber
\end{align}
\end{equation}

$\Omega_{PA}$ and $\Omega_{DA}$ are saturation factors for precipitation and dissolution of aragonite. $\Omega_{PC}$ and $\Omega_{DC}$ are saturation factors for precipitation and dissolution of calcite.

\subsection{Velocities of the solids, $U$ and $W$}
Equations below are adapted from Eqs. 46-47 in the article.
\begin{equation}
\begin{align}
    U &= 1 - \left(K(\phi^0)(1-\phi^0) + K(\phi)(1-\phi)\right) \frac{1}{S}\left(\frac{\rho_s}{\rho_w}-1\right) \nonumber \\
    W &= 1 - \left(K(\phi^0)(1-\phi^0) - K(\phi) \frac{(1-\phi)^2}{\phi}\right)\frac{1}{S}\left(\frac{\rho_s}{\rho_w}-1\right) \nonumber
\end{align}
\end{equation}

\subsection{Hydraulic conductivity $K(\phi)$}

\begin{equation}
    K = \beta \frac{\phi^3}{(1 - \phi)^2}F(\phi) \tag{15}
\end{equation}
where
\begin{equation}
    F(\phi) = 1 - \exp\left( -\frac{10(1-\phi)}{\phi} \right) \tag{17}
\end{equation}

\subsection{Porosity diffusion coefficient $d_{\phi}$}
$d_{\phi}$ is the dimensionless form, calculated as $d_{\phi} = D_{\phi}/D_{Ca}^0$. 
In the article and in our calculations, it is set to be constant, $7.708409\times10^{-4} << d_k$. The value of the constant is obtained as:
\begin{equation}
    D_{\phi} = -\left(1 - \phi\right)K(\phi)\frac{H}{g\rho_w} = \beta\frac{\phi^3}{(1 - \phi)}\frac{1}{bg\rho_w(\phi_{nr}-\phi_{\infty})}F \tag{25}
\end{equation}
where:\\
$H$ should be $H(\phi)$ - a function that links effective stress acting on sediment with the change in porosity\\
$b$ is a parameter (see table below)\\
$g$ is Earth's gravitational acceleration\\
$\beta$ is a parameter (see table below)\\
$\rho_w$ is the density of water (see table below)\\
$\phi_{nr}$ is stationary system porosity in the absence of reactions\\
$\phi_{\infty}$ is actually unclear
\section{Boundary conditions}
Upper/bottom is of course left/right, but since we are talking about a column of sediment, top and down is more intuitive.

\subsection{Upper boundary}
Dirichlet boundary conditions. For the case supposed to yield oscillations, they are:

\begin{table}
    \centering
    \begin{tabular}{cc}
         $C_A$& 0.6\\
         $C_C$& 0.3\\
         $\hat{c}_{Ca}$& 0.326\\
         $\hat{c}_{CO_3}$& 0.326\\
         $\phi$& 0.8\\
    \end{tabular}
    \caption{Upper boundary conditions}
\end{table}
\subsection{Bottom boundary}
There are no bottom boundary conditions in the article. This is likely a flaw of the model, because we don't know what happens when advection is reversed (negative).
In the numerical solution in Python, we use a dummy boundary condition at the bottom. To prevent it from affecting the integration, we use only backward differencing for the spatial derivatives in the right-hand sides of the time derivative equations for $C_A$ and $C_C$.

\section{Parameters}

\begin{table}
    \centering
    \begin{tabular}{cclll}
 Symbol& Formula& Value&Meaning &Units\\
 b& & 5& Sediment compressibility&$kPa^{-1}$\\
 $\beta$& & 0.1& Constant in the hydraulic conductivity&cm/a\\
 $d_{k=1}$& $\frac{D_{Ca}}{D_{Ca}^0}$& 1& Dim-less diffusion coefficient of Ca&-\\
 $d_{k=2}$& $\frac{D_{CO_{3}}}{D_{Ca}^0}$& 2.0667& Dim-less diffusion coefficient of $CO_3$&-\\
 $d_\phi$& $\frac{D_\phi}{D_{Ca}^0}$& $7.708409\times10^{-4}$& Dim-less diffusion coefficient of porosity&-\\
         Da&  $\frac{k_2D_{Ca}^0}{S^2}$& 13190&DamkÃ¶hler number &\\
 $\delta$& $\frac{\rho_s}{\mu_A\sqrt{K_C}}$& 43.7956& ?&\\
 $K_C$& & $10^{-6.37}$& Calcite solubility&$mol^2$\\
         $\lambda$&  $k_3/k_2$& 0.1& Dim-less reaction rate coefficient&\\
 $m, m'$& -& 2.48&Reaction order for $A$ precipitation and dissolution&-\\
 $\mu_A$& -& 100.09& Molar mass of aragonite&g/mol\\
 $n, n'$& -& 2.80&Reaction order for $C$ precipitation and dissolution&-\\
         $\nu_1$&  $k_1/k_2$& 1& Dim-less reaction rate of aragonite reactions&-\\
         $\nu_2$&  $k_4/k_3$& 1& Dim-less reaction rate of calcite reactions&-\\
         $\rho_s$&  & 2.863& Density of the sediment (all solids, i.e. $1 - \phi$)&\\
         $\rho_w$&  -& 1.023& Density of water&\\
 $S$& -& 0.1& Sedimentation rate&cm/a\\
    \end{tabular}
    \caption{Parameters of the model}
\end{table}

\end{document}